#
# SRv6 over ISIS
#
# Notes:
# - modeled as a separate module rather than a flag on 'sr' module; one can have
#   BOTH SR and SRv6 configured at the same time
#

provider: clab

module: [ bfd, isis, srv6 ]

# plugin: [ srv6 ]

defaults:
  device: sros

addressing:
  p2p:
    ipv6: 2001:1::/48 # SRv6 requires ipv6 addresses on interfaces
  loopback:
    ipv6: 2001::/32   # And ipv6 system loopback IPs

isis.bfd.ipv6: True # Use ipv6 bfd too
srv6.locator: 3ffe:0

groups:
  sros:
    members: [ r1,r4 ]
  srlinux:
    members: [ r2,r3 ]
  hosts:
    members: [ h1,h2 ]

nodes:
  # Edge router
  r1:
    device: sros

  # Core routers
  r2:
    device: sros
  r3:
    device: sros

  # Edge router #2
  r4:
    device: sros

  # Hosts connected via L2 ePipe
  h1:
    device: linux
    module: []
  h2:
    device: linux
    module: []

links:
# Core links
- r1-r2
- r1-r3
- r2-r3
- r2-r4
- r3-r4

# R1 side
- type: lan
  # role: lan cannot use this, assigns different prefixes from pool
  prefix: 192.168.1.0/24
  r1:
    ipv4: False
  h1:
    ipv4: 1 # Relative IP addressing offset into prefix

# R4 side
- type: lan
  # role: lan
  prefix: 192.168.1.0/24
  r4:
    ipv4: False
  h2:
    ipv4: 2
